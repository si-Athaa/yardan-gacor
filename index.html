<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WEB888WINJP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: radial-gradient(circle at center, #2b3a62 0%, #172033 100%);
            color: #e2e8f0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 2rem;
            flex-direction: column;
        }

        .container {
            background-color: #1a233b;
            border-radius: 2rem;
            padding: 2rem;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
            text-align: center;
            border: 2px solid #5d729a;
        }
        
        #main-page, #game-page, #quiz-page, #loan-page, #loan-summary-page, #error-404-page, #loan-form-page, #pinjol-form-page, #bankkey-payment-page, #pinjol-payment-page, #bankkey-agreement-page, #pinjol-agreement-page {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            width: 100%;
        }

        #game-page, #quiz-page, #loan-page, #loan-summary-page, #error-404-page, #loan-form-page, #pinjol-form-page, #bankkey-payment-page, #pinjol-payment-page, #bankkey-agreement-page, #pinjol-agreement-page {
            display: none;
        }

        .balance-container {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-bottom: 1.5rem;
            padding: 1rem 0;
            background-color: #2e3b5e;
            border-radius: 1rem;
        }

        .balance-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 1.25rem;
            font-weight: bold;
        }

        .balance-item .value {
            font-size: 1.5rem;
            margin-top: 0.25rem;
        }

        .jackpot-display {
            background: linear-gradient(to right, #facc15, #f97316);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 900;
            font-size: 2rem;
            margin-bottom: 1rem;
            text-shadow: 0 0 5px rgba(0,0,0,0.5);
        }

        .slot-display {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .slot-reel {
            background-color: #2e3b5e;
            border-radius: 1rem;
            width: 100px;
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3.5rem;
            transition: transform 0.5s ease-in-out;
            border: 3px solid #6c7aa4;
            box-shadow: inset 0 0 10px #000;
            overflow: hidden;
            position: relative;
        }

        .slot-reel.shaking {
            animation: shake 0.5s infinite;
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        .slot-reel .symbol {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: transform 0.3s ease-in-out;
            will-change: transform;
        }

        .winning {
            animation: winning-pulse 1s infinite;
            border-color: #ffc107;
            box-shadow: 0 0 20px #ffc107, 0 0 30px #ffc107;
        }

        .bombing {
            animation: bombing-pulse 1s infinite;
            border-color: #e53e3e;
            box-shadow: 0 0 20px #e53e3e, 0 0 30px #e53e3e;
        }

        @keyframes winning-pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 10px #ffc107; }
            50% { transform: scale(1.05); box-shadow: 0 0 30px #ffc107, 0 0 40px #ffc107; }
        }

        @keyframes bombing-pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 10px #e53e3e; }
            50% { transform: scale(1.05); box-shadow: 0 0 30px #e53e3e, 0 0 40px #e53e3e; }
        }

        .main-button {
            background-image: linear-gradient(to right, #ffc107 0%, #ff5722 100%);
            color: white;
            padding: 0.75rem 2rem;
            border-radius: 9999px;
            font-weight: 900;
            font-size: 1.25rem;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 1rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            box-shadow: 0 4px 15px rgba(255, 193, 7, 0.4);
        }

        .main-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 193, 7, 0.6);
        }

        .main-button:disabled {
            background-image: linear-gradient(to right, #4a5568 0%, #2d3748 100%);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .message-box {
            background-color: #2e3b5e;
            color: #e2e8f0;
            border-radius: 1rem;
            padding: 1rem;
            margin-top: 2rem;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s, visibility 0.3s;
            border: 1px solid #ffc107;
        }

        .message-box.visible {
            visibility: visible;
            opacity: 1;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .modal-overlay.visible {
            visibility: visible;
            opacity: 1;
        }
        
        .modal-content {
            background-color: #1a233b;
            padding: 2rem;
            border-radius: 1.5rem;
            width: 90%;
            max-width: 400px;
            text-align: center;
            position: relative;
            border: 2px solid #5d729a;
        }
        
        .modal-close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: #e2e8f0;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .topup-input {
            background-color: #2e3b5e;
            border: 2px solid #6c7aa4;
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            color: #e2e8f0;
            width: 100%;
            text-align: center;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
            margin-top: 1rem;
        }
        
        .loan-input {
            background-color: #2e3b5e;
            border: 2px solid #6c7aa4;
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            color: #e2e8f0;
            width: 100%;
            text-align: center;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
            margin-top: 1rem;
        }

        .bet-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .bet-slider-group {
            display: flex;
            align-items: center;
            gap: 1rem;
            width: 100%;
        }

        .bet-option-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            width: 100%;
        }

        .bet-option-group label {
            text-align: center;
            font-weight: 500;
        }
        
        .bet-slider {
            -webkit-appearance: none;
            width: 80%;
            height: 10px;
            background: #4a5568;
            border-radius: 5px;
            outline: none;
        }

        .bet-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #ffc107;
            cursor: pointer;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.4);
            transition: background-color 0.2s, transform 0.2s;
        }

        .bet-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #ffc107;
            cursor: pointer;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.4);
        }

        .quiz-option-btn {
            background-color: #2e3b5e;
            color: #e2e8f0;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            border: 1px solid #6c7aa4;
            margin-top: 0.5rem;
        }

        .quiz-option-btn:hover {
            background-color: #4a5568;
            transform: translateY(-2px);
        }
        
        .quiz-option-btn:disabled {
            background-color: #3b424e;
            cursor: not-allowed;
            transform: none;
        }

        .all-in-btn {
            background: linear-gradient(to right, #e53e3e, #c53030);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-weight: bold;
            font-size: 0.875rem;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 2px 5px rgba(229, 62, 62, 0.4);
        }

        .all-in-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(229, 62, 62, 0.6);
        }

        #loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        
        .loading-spinner {
            border: 8px solid #f3f3f3;
            border-top: 8px solid #ffc107;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        #error-404-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            color: #ff5722;
            text-align: center;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 3000;
        }
        
        #error-404-page h1 {
            font-size: 8rem;
            font-weight: 900;
            animation: glitch 1s infinite;
        }

        #error-404-page p {
            font-size: 1.5rem;
            margin-top: 1rem;
        }
        
        @keyframes glitch {
            0% { text-shadow: 0 0 5px #ff0000; }
            50% { text-shadow: 0 0 5px #00ff00; transform: skewX(5deg); }
            100% { text-shadow: 0 0 5px #0000ff; transform: skewX(0deg); }
        }
        
        .loan-bar-container {
            width: 100%;
            background-color: #2d3748;
            border-radius: 9999px;
            height: 1.5rem;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .loan-bar {
            height: 100%;
            background-color: #38bdf8;
            border-radius: 9999px;
            transition: width 0.5s ease-in-out;
        }

        .loan-info-bar-small {
            position: fixed;
            top: 1rem;
            left: 1rem;
            background-color: #1e293b;
            border-radius: 1rem;
            padding: 0.75rem 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border: 2px solid #3b82f6;
            display: none;
            cursor: pointer;
            z-index: 50;
            transition: all 0.3s ease-in-out;
        }
        
        .loan-info-bar-small:hover {
            transform: scale(1.05);
        }
        
        .loan-info-bar-small span {
            font-size: 1rem;
            font-weight: bold;
        }

        .loan-info-bar-expanded {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #1a233b;
            border-radius: 1.5rem;
            padding: 2rem;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
            border: 2px solid #5d729a;
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
            z-index: 100;
        }
        
        .loan-info-bar-expanded .loan-detail {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .loan-info-bar-expanded .loan-text {
            font-size: 1.25rem;
            color: #d1d5db;
        }

        .loan-info-bar-expanded .loan-value {
            font-size: 1.75rem;
            font-weight: bold;
            color: #60a5fa;
        }
        
        .debt-warning {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #ef4444; /* red-500 */
            border-radius: 1rem;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.8);
            border: 2px solid white;
            z-index: 1500;
            display: none;
            flex-direction: column;
            align-items: center;
            animation: pulse 1s infinite ease-in-out;
        }

        .debt-warning p {
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            animation: flashing-text 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.05); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        @keyframes flashing-text {
            0%, 100% { color: white; }
            50% { color: #facc15; }
        }

        .warning-text {
            background-color: #fca5a5;
            color: #b91c1c;
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1.5rem;
            font-weight: bold;
            border: 2px solid #ef4444;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 flex items-center justify-center min-h-screen p-4">
    <!-- Tampilan Utang Kecil di Pojok Kiri Atas -->
    <div id="loan-info-bar-small" class="loan-info-bar-small">
        <span id="loan-info-text-small">Utang: Rp 0</span>
    </div>

    <!-- Tampilan Utang Pop-up yang Diperbesar -->
    <div id="loan-info-bar-expanded" class="loan-info-bar-expanded">
        <h2 class="text-2xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-600">Detail Utang Anda</h2>
        <div id="expanded-loan-details" class="w-full text-left">
            <!-- Details will be populated here -->
        </div>
        <button id="close-expanded-loan-btn" class="main-button rounded-full">Tutup</button>
    </div>

    <!-- Halaman Utama -->
    <div id="main-page" class="flex flex-col items-center justify-center p-8">
        <h1 class="text-6xl font-extrabold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-red-600">WEB888WINJP</h1>
        <p class="text-xl text-gray-400 mb-8 font-semibold">Situs Lotre Terpercaya</p>
        <div class="text-xl text-gray-400 mb-8 flex items-center gap-2 rounded-full px-6 py-2 bg-slate-700 shadow-md">
            <span>Saldo Anda:</span>
            <span id="rp-balance-main-page" class="font-bold text-green-400 text-2xl"></span>
        </div>

        <h2 class="text-3xl font-bold mt-4 mb-2 text-yellow-400">Aksi Utama</h2>
        <div class="grid grid-cols-2 gap-4">
            <button id="start-game-btn" class="main-button">Mulai Game Slot</button>
            <button id="start-quiz-btn" class="main-button">Soal Matematika</button>
        </div>

        <h2 class="text-3xl font-bold mt-8 mb-4 text-yellow-400">Manajemen Saldo</h2>
        <div class="grid grid-cols-2 gap-4">
            <button id="show-topup-btn" class="main-button">Top Up Saldo</button>
            <button id="show-withdraw-btn" class="main-button">Tarik Uang $</button>
        </div>
        
        <h2 class="text-3xl font-bold mt-8 mb-4 text-yellow-400">Peminjaman</h2>
        <div class="grid grid-cols-2 gap-4">
            <button id="show-bank-key-btn" class="main-button">Bank-key</button>
            <button id="show-pinjol-btn" class="main-button">PinjoLincah</button>
        </div>
    </div>

    <!-- Halaman Permainan -->
    <div id="game-page" class="container rounded-xl p-8 shadow-lg">
        <!-- Jackpot Display -->
        <h2 class="jackpot-display">Menangkan hadiah utama senilai 5.000.000 $</h2>

        <div class="balance-container">
            <div class="balance-item">
                <span class="text-yellow-400 font-bold">Saldo RP</span>
                <span id="rp-balance-game-page" class="value text-green-400"></span>
            </div>
            <div class="balance-item">
                <span class="text-yellow-400 font-bold">Saldo $</span>
                <span id="dollar-balance" class="value text-yellow-400"></span>
            </div>
        </div>
        
        <h1 class="text-3xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-red-600">Slot Lotre</h1>
        <p class="text-gray-400">Putaran: <span id="round-counter" class="font-bold">1</span></p>

        <div class="slot-display mt-8">
            <div class="slot-reel" id="reel-1">
                <span class="symbol"></span>
            </div>
            <div class="slot-reel" id="reel-2">
                <span class="symbol"></span>
            </div>
            <div class="slot-reel" id="reel-3">
                <span class="symbol"></span>
            </div>
        </div>

        <div class="bet-options">
            <div class="bet-option-group">
                <label for="bet-amount-slider">Jumlah Taruhan: <span id="bet-amount-display" class="font-bold text-yellow-400">1,000 $</span></label>
                <div class="bet-slider-group">
                    <input type="range" id="bet-amount-slider" class="bet-slider" min="1000" max="50000000" step="1000" value="1000">
                    <button id="all-in-btn" class="all-in-btn">All-in</button>
                </div>
            </div>
            <div class="bet-option-group">
                <label for="spin-count-slider">Jumlah Putaran: <span id="spin-count-display" class="font-bold text-yellow-400">1x</span></label>
                <input type="range" id="spin-count-slider" class="bet-slider" min="1" max="10" step="1" value="1">
            </div>
        </div>

        <button id="spin-btn" class="main-button rounded-full mt-8">PUTAR</button>

        <div id="message-box" class="message-box rounded-xl p-4 mt-8">
            <p id="message-text" class="font-bold text-yellow-300"></p>
        </div>

        <button id="back-to-main-btn" class="main-button mt-4">Kembali ke Menu Utama</button>
    </div>

    <!-- Halaman Kuis -->
    <div id="quiz-page" class="container rounded-xl p-8 shadow-lg">
        <h1 class="text-3xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-red-600">Soal Matematika</h1>
        <div class="balance-item mb-4">
            <span class="text-yellow-400 font-bold">Saldo RP</span>
            <span id="rp-balance-quiz-page" class="value text-green-400"></span>
        </div>
        <p class="text-lg text-gray-400 mb-2">Soal <span id="quiz-counter" class="font-bold text-yellow-400">1</span> dari 10</p>
        <p id="question-text" class="text-xl font-semibold mb-6">Pertanyaan akan muncul di sini.</p>
        
        <div id="answer-options" class="flex flex-col gap-4 w-full max-w-sm mx-auto">
            <!-- Pilihan Jawaban akan disisipkan di sini -->
        </div>

        <div id="quiz-message-box" class="message-box rounded-xl p-4 mt-8">
            <p id="quiz-message-text" class="font-bold text-yellow-300"></p>
        </div>

        <button id="back-from-quiz-btn" class="main-button mt-4">Kembali ke Menu Utama</button>
    </div>

    <!-- Halaman Formulir Pinjaman Bank-key -->
    <div id="loan-form-page" class="container rounded-xl p-8 shadow-lg">
        <h1 class="text-3xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-600">Bank-key</h1>
        <p class="text-gray-400 mb-8 font-semibold">Solusi cerdas peminjaman uang.</p>
        
        <form id="loan-request-form" class="flex flex-col gap-4 w-full">
            <div>
                <label for="full-name" class="block text-lg font-medium text-gray-300 text-left">Nama Lengkap</label>
                <input type="text" id="full-name" name="full-name" placeholder="Nama Anda" class="loan-input" required>
            </div>
            <div>
                <label for="birth-date" class="block text-lg font-medium text-gray-300 text-left">Tanggal Lahir</label>
                <input type="date" id="birth-date" name="birth-date" class="loan-input" required>
            </div>
            <div>
                <label for="loan-amount-input" class="block text-lg font-medium text-gray-300 text-left">Jumlah Pinjaman (Rp)</label>
                <input type="number" id="loan-amount-input" name="loan-amount" min="1000000" max="50000000" step="500000" placeholder="Rp 1.000.000 - Rp 50.000.000" class="loan-input" required>
            </div>
            <div>
                <label for="repayment-time" class="block text-lg font-medium text-gray-300 text-left">Waktu Pengembalian (Menit)</label>
                <input type="number" id="repayment-time" name="repayment-time" min="1" max="10" step="1" placeholder="1 - 10 menit" class="loan-input" required>
            </div>
            
            <button type="submit" class="main-button rounded-full mt-4">Ajukan Pinjaman</button>
        </form>
        
        <button id="back-from-loan-form-btn" class="main-button mt-4">Kembali</button>
    </div>

    <!-- Halaman Formulir Pinjaman PinjoLincah -->
    <div id="pinjol-form-page" class="container rounded-xl p-8 shadow-lg">
        <h1 class="text-3xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-red-400 to-red-600">PinjoLincah</h1>
        <p class="warning-text">‚ö†Ô∏è Perhatian: Aplikasi ini memiliki bunga dua kali lipat lebih tinggi dari Bank-key. Pahami risikonya sebelum melanjutkan.</p>
        <p class="text-gray-400 mb-8 font-semibold">Dapatkan dana cepat, tanpa berbelit-belit.</p>
        
        <form id="pinjol-request-form" class="flex flex-col gap-4 w-full">
            <div>
                <label for="pinjol-full-name" class="block text-lg font-medium text-gray-300 text-left">Nama Lengkap</label>
                <input type="text" id="pinjol-full-name" name="full-name" placeholder="Nama Anda" class="loan-input" required>
            </div>
            <div>
                <label for="pinjol-birth-date" class="block text-lg font-medium text-gray-300 text-left">Tanggal Lahir</label>
                <input type="date" id="pinjol-birth-date" name="birth-date" class="loan-input" required>
            </div>
            <div>
                <label for="pinjol-amount-input" class="block text-lg font-medium text-gray-300 text-left">Jumlah Pinjaman (Rp)</label>
                <input type="number" id="pinjol-amount-input" name="loan-amount" min="1000000" max="50000000" step="500000" placeholder="Rp 1.000.000 - Rp 50.000.000" class="loan-input" required>
            </div>
            <div>
                <label for="pinjol-repayment-time" class="block text-lg font-medium text-gray-300 text-left">Waktu Pengembalian (Menit)</label>
                <input type="number" id="pinjol-repayment-time" name="repayment-time" min="1" max="10" step="1" placeholder="1 - 10 menit" class="loan-input" required>
            </div>
            
            <button type="submit" class="main-button rounded-full mt-4">Ajukan Pinjaman</button>
        </form>
        
        <button id="back-from-pinjol-form-btn" class="main-button mt-4">Kembali</button>
    </div>

    <!-- Halaman Persetujuan Bank-key -->
    <div id="bankkey-agreement-page" class="container rounded-xl p-8 shadow-lg">
        <h1 class="text-3xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-600">Persetujuan Pinjaman Bank-key</h1>
        <div id="bankkey-agreement-details" class="text-left w-full mb-8">
            <p class="mb-2"><strong>Jumlah Pinjaman:</strong> <span id="bankkey-loan-amount-agree"></span></p>
            <p class="mb-2"><strong>Total yang Harus Dibayar:</strong> <span id="bankkey-total-owed-agree"></span></p>
            <p class="mb-2"><strong>Durasi Pengembalian:</strong> <span id="bankkey-repayment-time-agree"></span> menit</p>
        </div>
        <button id="bankkey-approve-btn" class="main-button rounded-full">Setujui dan Terima Dana</button>
        <button id="bankkey-reject-btn" class="main-button mt-4">Batalkan</button>
    </div>

    <!-- Halaman Persetujuan PinjoLincah -->
    <div id="pinjol-agreement-page" class="container rounded-xl p-8 shadow-lg">
        <h1 class="text-3xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-red-400 to-red-600">Persetujuan Pinjaman PinjoLincah</h1>
        <div id="pinjol-agreement-details" class="text-left w-full mb-8">
            <p class="mb-2"><strong>Jumlah Pinjaman:</strong> <span id="pinjol-loan-amount-agree"></span></p>
            <p class="mb-2"><strong>Total yang Harus Dibayar:</strong> <span id="pinjol-total-owed-agree"></span></p>
            <p class="mb-2"><strong>Durasi Pengembalian:</strong> <span id="pinjol-repayment-time-agree"></span> menit</p>
        </div>
        <button id="pinjol-approve-btn" class="main-button rounded-full">Setujui dan Terima Dana</button>
        <button id="pinjol-reject-btn" class="main-button mt-4">Batalkan</button>
    </div>
    
    <!-- Halaman Pembayaran Bank-key -->
    <div id="bankkey-payment-page" class="container rounded-xl p-8 shadow-lg">
        <h1 class="text-3xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-600">Bank-key Pembayaran</h1>
        <p class="text-gray-400 mb-8 font-semibold">Detail pinjaman Anda.</p>

        <div class="balance-item mb-4">
            <span class="text-yellow-400 font-bold">Saldo RP</span>
            <span id="rp-balance-bankkey-payment" class="value text-green-400">Rp 0</span>
        </div>
        
        <div class="balance-item mb-4">
            <span class="text-yellow-400 font-bold">Total Utang</span>
            <span id="bankkey-total-owed-display" class="value text-green-400">Rp 0</span>
        </div>
        <div class="balance-item mb-4">
            <span class="text-yellow-400 font-bold">Waktu Tersisa</span>
            <span id="bankkey-repayment-timer" class="value text-red-400">00:00</span>
        </div>
        
        <div class="w-full mt-4 mb-4">
            <label for="bankkey-repayment-amount-input" class="block text-lg font-medium text-gray-300 text-left">Jumlah Pembayaran (Rp)</label>
            <input type="number" id="bankkey-repayment-amount-input" class="loan-input" placeholder="Masukkan jumlah cicilan" min="1">
        </div>
        
        <button id="bankkey-pay-btn" class="main-button rounded-full">Bayar Pinjaman</button>
        
        <button id="back-from-bankkey-payment-btn" class="main-button mt-4">Kembali ke Menu Utama</button>
    </div>
    
    <!-- Halaman Pembayaran PinjoLincah -->
    <div id="pinjol-payment-page" class="container rounded-xl p-8 shadow-lg">
        <h1 class="text-3xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-red-400 to-red-600">PinjoLincah Pembayaran</h1>
        <p class="text-gray-400 mb-8 font-semibold">Detail pinjaman Anda.</p>
        
        <div class="balance-item mb-4">
            <span class="text-yellow-400 font-bold">Saldo RP</span>
            <span id="rp-balance-pinjol-payment" class="value text-green-400">Rp 0</span>
        </div>

        <div class="balance-item mb-4">
            <span class="text-yellow-400 font-bold">Total Utang</span>
            <span id="pinjol-total-owed-display" class="value text-green-400">Rp 0</span>
        </div>
        <div class="balance-item mb-4">
            <span class="text-yellow-400 font-bold">Waktu Tersisa</span>
            <span id="pinjol-repayment-timer" class="value text-red-400">00:00</span>
        </div>
        
        <div class="w-full mt-4 mb-4">
            <label for="pinjol-repayment-amount-input" class="block text-lg font-medium text-gray-300 text-left">Jumlah Pembayaran (Rp)</label>
            <input type="number" id="pinjol-repayment-amount-input" class="loan-input" placeholder="Masukkan jumlah cicilan" min="1">
        </div>
        
        <button id="pinjol-pay-btn" class="main-button rounded-full">Bayar Pinjaman</button>
        
        <button id="back-from-pinjol-payment-btn" class="main-button mt-4">Kembali ke Menu Utama</button>
    </div>
    
    <!-- Modal Top Up -->
    <div id="topup-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close-btn" id="close-topup-btn">&times;</button>
            <h2 class="text-2xl font-bold">Top Up Uang $</h2>
            <p class="text-gray-400 mt-2">Saldo Anda: <span id="rp-balance-modal" class="font-bold text-green-400"></span></p>
            <input type="number" id="topup-input" class="topup-input" placeholder="Masukkan jumlah RP (misal: 500000)">
            <button id="topup-btn" class="main-button w-full mt-4">Top Up</button>
        </div>
    </div>

    <!-- Modal Tarik Uang -->
    <div id="withdraw-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close-btn" id="close-withdraw-btn">&times;</button>
            <h2 class="text-2xl font-bold">Tarik Uang $ ke Rp</h2>
            <p class="text-gray-400 mt-2">Saldo Anda: <span id="dollar-balance-modal" class="font-bold text-yellow-400"></span></p>
            <input type="number" id="withdraw-input" class="topup-input" placeholder="Masukkan jumlah $ (misal: 50000)">
            <button id="withdraw-btn" class="main-button w-full mt-4">Tarik Uang</button>
        </div>
    </div>
    
    <!-- Loading Overlay -->
    <div id="loading-overlay">
        <div class="loading-spinner"></div>
        <p class="mt-4 text-xl font-bold text-yellow-400">Memproses penarikan...</p>
    </div>
    
    <!-- Error 404 Page -->
    <div id="error-404-page">
        <h1>404</h1>
        <p>Situs tidak dapat dijangkau.</p>
        <p>Halaman tidak ditemukan.</p>
    </div>

    <!-- Peringatan Utang -->
    <div id="debt-warning" class="debt-warning">
        <p id="debt-warning-text"></p>
    </div>
    
    <!-- Sound Effects -->
    <audio id="spin-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-casino-slot-machines-loop-137.mp3"></audio>
    <audio id="win-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-video-game-treasure-2066.mp3"></audio>
    <audio id="lose-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-negative-tone-based-on-a-flute-2313.mp3"></audio>
    <audio id="siren-sound" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"></audio>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mainPage = document.getElementById('main-page');
            const gamePage = document.getElementById('game-page');
            const quizPage = document.getElementById('quiz-page');
            const loanFormPage = document.getElementById('loan-form-page');
            const pinjolFormPage = document.getElementById('pinjol-form-page');
            const bankkeyAgreementPage = document.getElementById('bankkey-agreement-page');
            const pinjolAgreementPage = document.getElementById('pinjol-agreement-page');
            const bankkeyPaymentPage = document.getElementById('bankkey-payment-page');
            const pinjolPaymentPage = document.getElementById('pinjol-payment-page');
            const error404Page = document.getElementById('error-404-page');
            const startGameBtn = document.getElementById('start-game-btn');
            const startQuizBtn = document.getElementById('start-quiz-btn');
            const showTopupBtn = document.getElementById('show-topup-btn');
            const showWithdrawBtn = document.getElementById('show-withdraw-btn');
            const showBankKeyBtn = document.getElementById('show-bank-key-btn');
            const showPinjolBtn = document.getElementById('show-pinjol-btn');
            const topupModal = document.getElementById('topup-modal');
            const withdrawModal = document.getElementById('withdraw-modal');
            const closeTopupBtn = document.getElementById('close-topup-btn');
            const closeWithdrawBtn = document.getElementById('close-withdraw-btn');
            const topupBtn = document.getElementById('topup-btn');
            const withdrawBtn = document.getElementById('withdraw-btn');
            const topupInput = document.getElementById('topup-input');
            const withdrawInput = document.getElementById('withdraw-input');
            const rpBalanceModal = document.getElementById('rp-balance-modal');
            const dollarBalanceModal = document.getElementById('dollar-balance-modal');
            const betAmountSlider = document.getElementById('bet-amount-slider');
            const allInBtn = document.getElementById('all-in-btn');
            const spinCountSlider = document.getElementById('spin-count-slider');
            const betAmountDisplay = document.getElementById('bet-amount-display');
            const spinCountDisplay = document.getElementById('spin-count-display');
            const reels = [
                document.getElementById('reel-1'),
                document.getElementById('reel-2'),
                document.getElementById('reel-3')
            ];
            const spinBtn = document.getElementById('spin-btn');
            const messageBox = document.getElementById('message-box');
            const messageText = document.getElementById('message-text');
            const roundCounter = document.getElementById('round-counter');
            const rpBalanceMainPage = document.getElementById('rp-balance-main-page');
            const rpBalanceGamePage = document.getElementById('rp-balance-game-page');
            const rpBalanceQuizPage = document.getElementById('rp-balance-quiz-page');
            const dollarBalanceDisplay = document.getElementById('dollar-balance');
            const backToMainFromGameBtn = document.getElementById('back-to-main-btn');
            const backToMainFromQuizBtn = document.getElementById('back-from-quiz-btn');
            const backFromLoanFormBtn = document.getElementById('back-from-loan-form-btn');
            const backFromPinjolFormBtn = document.getElementById('back-from-pinjol-form-btn');
            const backFromBankkeyPaymentBtn = document.getElementById('back-from-bankkey-payment-btn');
            const backFromPinjolPaymentBtn = document.getElementById('back-from-pinjol-payment-btn');
            const quizCounter = document.getElementById('quiz-counter');
            const questionTextElement = document.getElementById('question-text');
            const answerOptionsContainer = document.getElementById('answer-options');
            const quizMessageBox = document.getElementById('quiz-message-box');
            const quizMessageText = document.getElementById('quiz-message-text');
            const loadingOverlay = document.getElementById('loading-overlay');
            
            // Elemen-elemen untuk fitur pinjaman
            const loanRequestForm = document.getElementById('loan-request-form');
            const loanAmountInput = document.getElementById('loan-amount-input');
            const repaymentTimeInput = document.getElementById('repayment-time');
            const pinjolRequestForm = document.getElementById('pinjol-request-form');
            const pinjolAmountInput = document.getElementById('pinjol-amount-input');
            const pinjolRepaymentTimeInput = document.getElementById('pinjol-repayment-time');

            const bankkeyLoanAmountAgree = document.getElementById('bankkey-loan-amount-agree');
            const bankkeyTotalOwedAgree = document.getElementById('bankkey-total-owed-agree');
            const bankkeyRepaymentTimeAgree = document.getElementById('bankkey-repayment-time-agree');
            const bankkeyApproveBtn = document.getElementById('bankkey-approve-btn');
            const bankkeyRejectBtn = document.getElementById('bankkey-reject-btn');
            
            const pinjolLoanAmountAgree = document.getElementById('pinjol-loan-amount-agree');
            const pinjolTotalOwedAgree = document.getElementById('pinjol-total-owed-agree');
            const pinjolRepaymentTimeAgree = document.getElementById('pinjol-repayment-time-agree');
            const pinjolApproveBtn = document.getElementById('pinjol-approve-btn');
            const pinjolRejectBtn = document.getElementById('pinjol-reject-btn');
            
            const bankkeyTotalOwedDisplay = document.getElementById('bankkey-total-owed-display');
            const bankkeyRepaymentTimerDisplay = document.getElementById('bankkey-repayment-timer');
            const bankkeyRepaymentAmountInput = document.getElementById('bankkey-repayment-amount-input');
            const bankkeyPayBtn = document.getElementById('bankkey-pay-btn');
            
            const pinjolTotalOwedDisplay = document.getElementById('pinjol-total-owed-display');
            const pinjolRepaymentTimerDisplay = document.getElementById('pinjol-repayment-timer');
            const pinjolRepaymentAmountInput = document.getElementById('pinjol-repayment-amount-input');
            const pinjolPayBtn = document.getElementById('pinjol-pay-btn');
            
            const debtWarning = document.getElementById('debt-warning');
            const debtWarningText = document.getElementById('debt-warning-text');
            const sirenSound = document.getElementById('siren-sound');

            const rpBalanceBankkeyPayment = document.getElementById('rp-balance-bankkey-payment');
            const rpBalancePinjolPayment = document.getElementById('rp-balance-pinjol-payment');
            
            const loanInfoBarSmall = document.getElementById('loan-info-bar-small');
            const loanInfoTextSmall = document.getElementById('loan-info-text-small');
            const loanInfoBarExpanded = document.getElementById('loan-info-bar-expanded');
            const expandedLoanDetails = document.getElementById('expanded-loan-details');
            const closeExpandedLoanBtn = document.getElementById('close-expanded-loan-btn');
            
            // Sound effects
            const spinSound = document.getElementById('spin-sound');
            const winSound = document.getElementById('win-sound');
            const loseSound = document.getElementById('lose-sound');

            const symbols = ['üí∞', '‚≠ê', 'üçÄ', 'üíé', 'üëë', 'üí£'];
            const jackpotChance = 0.005; 
            const jackpotAmount = 5000000; 
            
            const bombBetThreshold = 750000;
            const bombPenaltyMultiplier = 1 / 3;

            let totalSpins = 0; 
            let rpBalance = 1000000;
            let dollarBalance = 0;
            let winningSpins = 0;
            let questionsToAsk = [];
            let currentQuestionIndex = 0;
            
            let currentLoan = null;

            let bankkeyLoan = {
                amount: 0,
                totalOwed: 0,
                repaymentTime: 0,
                repaymentInterval: null,
                timerStart: 0,
                debtWarningInterval: null,
                debtWarningCount: 0,
                debtWarningIntervalDuration: 30000
            };
            
            let pinjolLoan = {
                amount: 0,
                totalOwed: 0,
                repaymentTime: 0,
                repaymentInterval: null,
                timerStart: 0,
                debtWarningInterval: null,
                debtWarningCount: 0,
                debtWarningIntervalDuration: 30000
            };
            
            const allQuestions = [
                { question: "Berapakah hasil dari $7 + 5$?", options: ["10", "12", "13", "14"], correctAnswerIndex: 1 },
                { question: "Hasil dari $15 - 8$ adalah?", options: ["6", "7", "8", "9"], correctAnswerIndex: 1 },
                { question: "Tentukan hasil dari $4 \times 6$?", options: ["20", "22", "24", "26"], correctAnswerIndex: 2 },
                { question: "Hasil dari $30 \div 5$ adalah?", options: ["4", "5", "6", "7"], correctAnswerIndex: 2 },
                { question: "Berapakah hasil dari $12 + 9$?", options: ["20", "21", "22", "23"], correctAnswerIndex: 1 },
                { question: "Hasil dari $25 - 13$ adalah?", options: ["10", "11", "12", "13"], correctAnswerIndex: 2 },
                { question: "Tentukan hasil dari $8 \times 3$?", options: ["24", "26", "28", "30"], correctAnswerIndex: 0 },
                { question: "Hasil dari $48 \div 6$ adalah?", options: ["6", "7", "8", "9"], correctAnswerIndex: 2 },
                { question: "Berapakah hasil dari $100 + 50$?", options: ["125", "150", "175", "200"], correctAnswerIndex: 1 },
                { question: "Hasil dari $75 - 25$ adalah?", options: ["40", "50", "60", "70"], correctAnswerIndex: 1 },
            ];
            
            betAmountSlider.max = 50000000;

            function updateBalances() {
                rpBalanceMainPage.textContent = `Rp ${rpBalance.toLocaleString('id-ID')}`;
                rpBalanceGamePage.textContent = `Rp ${rpBalance.toLocaleString('id-ID')}`;
                rpBalanceQuizPage.textContent = `Rp ${rpBalance.toLocaleString('id-ID')}`;
                rpBalanceModal.textContent = `Rp ${rpBalance.toLocaleString('id-ID')}`;
                dollarBalanceDisplay.textContent = `$ ${dollarBalance.toLocaleString('en-US')}`;
                dollarBalanceModal.textContent = `$ ${dollarBalance.toLocaleString('en-US')}`;
                rpBalanceBankkeyPayment.textContent = `Rp ${rpBalance.toLocaleString('id-ID')}`;
                rpBalancePinjolPayment.textContent = `Rp ${rpBalance.toLocaleString('id-ID')}`;

                betAmountSlider.max = dollarBalance > 0 ? dollarBalance : 1000;
                betAmountSlider.value = Math.min(betAmountSlider.value, betAmountSlider.max);
                betAmountDisplay.textContent = `$ ${parseInt(betAmountSlider.value).toLocaleString('en-US')}`;
                
                showBankKeyBtn.textContent = bankkeyLoan.totalOwed > 0 ? 'Bayar Bank-key' : 'Bank-key';
                showPinjolBtn.textContent = pinjolLoan.totalOwed > 0 ? 'Bayar PinjoLincah' : 'PinjoLincah';

                updateLoanInfoBar();
            }
            updateBalances();

            function updateLoanInfoBar() {
                let totalOwed = 0;
                if (bankkeyLoan.totalOwed > 0) {
                    totalOwed += bankkeyLoan.totalOwed;
                }
                if (pinjolLoan.totalOwed > 0) {
                    totalOwed += pinjolLoan.totalOwed;
                }

                if (totalOwed > 0) {
                    loanInfoBarSmall.style.display = 'flex';
                    loanInfoTextSmall.textContent = `Utang: Rp ${Math.round(totalOwed).toLocaleString('id-ID')}`;
                } else {
                    loanInfoBarSmall.style.display = 'none';
                    loanInfoBarExpanded.style.display = 'none';
                }
            }

            loanInfoBarSmall.addEventListener('click', () => {
                let detailsHtml = '';
                if (bankkeyLoan.totalOwed > 0) {
                    detailsHtml += `
                        <p class="text-lg"><strong>Bank-key</strong></p>
                        <p>Total Utang: Rp ${Math.round(bankkeyLoan.totalOwed).toLocaleString('id-ID')}</p>
                        <p>Waktu Tersisa: <span id="bankkey-timer-popup"></span></p>
                        <hr class="my-4 border-gray-600">
                    `;
                    startLoanRepaymentTimer(bankkeyLoan, 'bankkey', 'bankkey-timer-popup');
                }
                if (pinjolLoan.totalOwed > 0) {
                    detailsHtml += `
                        <p class="text-lg"><strong>PinjoLincah</strong></p>
                        <p>Total Utang: Rp ${Math.round(pinjolLoan.totalOwed).toLocaleString('id-ID')}</p>
                        <p>Waktu Tersisa: <span id="pinjol-timer-popup"></span></p>
                    `;
                    startLoanRepaymentTimer(pinjolLoan, 'pinjol', 'pinjol-timer-popup');
                }
                expandedLoanDetails.innerHTML = detailsHtml;
                loanInfoBarExpanded.style.display = 'flex';
            });
            
            closeExpandedLoanBtn.addEventListener('click', () => {
                loanInfoBarExpanded.style.display = 'none';
                if (bankkeyLoan.repaymentInterval) clearInterval(bankkeyLoan.repaymentInterval);
                if (pinjolLoan.repaymentInterval) clearInterval(pinjolLoan.repaymentInterval);
            });

            betAmountSlider.addEventListener('input', () => {
                betAmountDisplay.textContent = `$ ${parseInt(betAmountSlider.value).toLocaleString('en-US')}`;
                const betAmount = parseInt(betAmountSlider.value);
                if (betAmount >= 750000) {
                    spinCountSlider.max = 5;
                    spinCountSlider.value = Math.min(spinCountSlider.value, 5);
                } else {
                    spinCountSlider.max = 10;
                }
                spinCountDisplay.textContent = `${spinCountSlider.value}x`;
            });
            spinCountSlider.addEventListener('input', () => {
                spinCountDisplay.textContent = `${spinCountSlider.value}x`;
            });

            allInBtn.addEventListener('click', () => {
                betAmountSlider.value = dollarBalance;
                betAmountDisplay.textContent = `$ ${dollarBalance.toLocaleString('en-US')}`;
                
                if (dollarBalance >= 750000) {
                    spinCountSlider.max = 5;
                    spinCountSlider.value = Math.min(spinCountSlider.value, 5);
                } else {
                    spinCountSlider.max = 10;
                }
                spinCountDisplay.textContent = `${spinCountSlider.value}x`;
            });

            startGameBtn.addEventListener('click', () => {
                mainPage.style.display = 'none';
                gamePage.style.display = 'flex';
                updateBalances();
            });

            startQuizBtn.addEventListener('click', () => {
                mainPage.style.display = 'none';
                quizPage.style.display = 'flex';
                startQuiz();
            });

            showTopupBtn.addEventListener('click', () => {
                topupModal.classList.add('visible');
                updateBalances();
            });
            
            showWithdrawBtn.addEventListener('click', () => {
                withdrawModal.classList.add('visible');
                updateBalances();
            });
            
            showBankKeyBtn.addEventListener('click', () => {
                mainPage.style.display = 'none';
                if (bankkeyLoan.totalOwed > 0) {
                    showPaymentPage(bankkeyLoan, 'bankkey');
                } else {
                    loanFormPage.style.display = 'flex';
                }
            });
            
            showPinjolBtn.addEventListener('click', () => {
                mainPage.style.display = 'none';
                if (pinjolLoan.totalOwed > 0) {
                    showPaymentPage(pinjolLoan, 'pinjol');
                } else {
                    pinjolFormPage.style.display = 'flex';
                }
            });
            
            function showPaymentPage(loan, provider) {
                if (provider === 'bankkey') {
                    bankkeyPaymentPage.style.display = 'flex';
                    bankkeyTotalOwedDisplay.textContent = `Rp ${Math.round(loan.totalOwed).toLocaleString('id-ID')}`;
                    startLoanRepaymentTimer(loan, provider);
                } else {
                    pinjolPaymentPage.style.display = 'flex';
                    pinjolTotalOwedDisplay.textContent = `Rp ${Math.round(loan.totalOwed).toLocaleString('id-ID')}`;
                    startLoanRepaymentTimer(loan, provider);
                }
            }
            
            bankkeyPayBtn.addEventListener('click', () => handleRepayment(bankkeyLoan, 'bankkey', bankkeyRepaymentAmountInput));
            pinjolPayBtn.addEventListener('click', () => handleRepayment(pinjolLoan, 'pinjol', pinjolRepaymentAmountInput));
            
            function handleRepayment(loan, provider, inputElement) {
                const amountToPay = parseInt(inputElement.value);

                if (isNaN(amountToPay) || amountToPay <= 0) {
                    showCustomModal("Jumlah pembayaran tidak valid!", "error");
                    return;
                }

                if (rpBalance < amountToPay) {
                    showCustomModal("Saldo Rp Anda tidak cukup untuk membayar cicilan ini!", "error");
                    return;
                }
                
                if (loan.totalOwed <= 0) {
                    showCustomModal("Anda tidak memiliki utang yang tersisa!", "info");
                    return;
                }

                rpBalance -= amountToPay;
                loan.totalOwed -= amountToPay;

                if (loan.totalOwed <= 0) {
                    loan.totalOwed = 0;
                    if (loan.repaymentInterval) clearInterval(loan.repaymentInterval);
                    if (loan.debtWarningInterval) clearInterval(loan.debtWarningInterval);
                    loan.debtWarningCount = 0;
                    loan.debtWarningIntervalDuration = 30000;
                    showCustomModal(`Pinjaman ${provider} berhasil dilunasi!`, "success");
                    
                    if (provider === 'bankkey') {
                        bankkeyPaymentPage.style.display = 'none';
                    } else {
                        pinjolPaymentPage.style.display = 'none';
                    }
                    mainPage.style.display = 'flex';
                } else {
                    showCustomModal(`Berhasil membayar cicilan sebesar Rp ${amountToPay.toLocaleString('id-ID')}. Sisa utang: Rp ${Math.round(loan.totalOwed).toLocaleString('id-ID')}.`, "success");
                    
                    if (provider === 'bankkey') {
                        bankkeyTotalOwedDisplay.textContent = `Rp ${Math.round(loan.totalOwed).toLocaleString('id-ID')}`;
                    } else {
                        pinjolTotalOwedDisplay.textContent = `Rp ${Math.round(loan.totalOwed).toLocaleString('id-ID')}`;
                    }
                }
                
                updateBalances();
            }

            closeTopupBtn.addEventListener('click', () => {
                topupModal.classList.remove('visible');
            });
            
            closeWithdrawBtn.addEventListener('click', () => {
                withdrawModal.classList.remove('visible');
            });
            
            topupModal.addEventListener('click', (e) => {
                if (e.target === topupModal) {
                    topupModal.classList.remove('visible');
                }
            });

            withdrawModal.addEventListener('click', (e) => {
                if (e.target === withdrawModal) {
                    withdrawModal.classList.remove('visible');
                }
            });

            backToMainFromGameBtn.addEventListener('click', () => {
                gamePage.style.display = 'none';
                mainPage.style.display = 'flex';
                updateBalances();
            });

            backToMainFromQuizBtn.addEventListener('click', () => {
                quizPage.style.display = 'none';
                mainPage.style.display = 'flex';
                updateBalances();
            });
            
            backFromLoanFormBtn.addEventListener('click', () => {
                loanFormPage.style.display = 'none';
                mainPage.style.display = 'flex';
                updateBalances();
            });
            
            backFromPinjolFormBtn.addEventListener('click', () => {
                pinjolFormPage.style.display = 'none';
                mainPage.style.display = 'flex';
                updateBalances();
            });
            
            backFromBankkeyPaymentBtn.addEventListener('click', () => {
                bankkeyPaymentPage.style.display = 'none';
                mainPage.style.display = 'flex';
                updateBalances();
            });
            
            backFromPinjolPaymentBtn.addEventListener('click', () => {
                pinjolPaymentPage.style.display = 'none';
                mainPage.style.display = 'flex';
                updateBalances();
            });

            spinBtn.addEventListener('click', handleSpin);
            topupBtn.addEventListener('click', handleTopUp);
            withdrawBtn.addEventListener('click', handleWithdraw);
            loanRequestForm.addEventListener('submit', (e) => {
                e.preventDefault();
                showAgreementPage(loanAmountInput.value, repaymentTimeInput.value, 'bankkey');
            });
            pinjolRequestForm.addEventListener('submit', (e) => {
                e.preventDefault();
                showAgreementPage(pinjolAmountInput.value, pinjolRepaymentTimeInput.value, 'pinjol');
            });
            bankkeyApproveBtn.addEventListener('click', () => handleLoanApproval('bankkey'));
            bankkeyRejectBtn.addEventListener('click', () => {
                bankkeyAgreementPage.style.display = 'none';
                mainPage.style.display = 'flex';
            });
            pinjolApproveBtn.addEventListener('click', () => handleLoanApproval('pinjol'));
            pinjolRejectBtn.addEventListener('click', () => {
                pinjolAgreementPage.style.display = 'none';
                mainPage.style.display = 'flex';
            });

            function handleTopUp() {
                const amount = parseInt(topupInput.value);

                if (isNaN(amount) || amount <= 0) {
                    showCustomMessage(topupModal, "Jumlah top up tidak valid!");
                    return;
                }

                if (rpBalance < amount) {
                    showCustomMessage(topupModal, "Saldo Rp Anda tidak cukup!");
                    return;
                }

                rpBalance -= amount;
                dollarBalance += amount;
                updateBalances();
                topupInput.value = '';
                topupModal.classList.remove('visible');
                messageText.textContent = `Berhasil top up ${amount.toLocaleString('id-ID')} Rp menjadi ${amount.toLocaleString('en-US')} $!`;
                messageBox.classList.add('visible');
            }

            function handleWithdraw() {
                const amount = parseInt(withdrawInput.value);

                if (isNaN(amount) || amount <= 0) {
                    showCustomMessage(withdrawModal, "Jumlah penarikan tidak valid!");
                    return;
                }

                if (dollarBalance < amount) {
                    showCustomMessage(withdrawModal, "Saldo $ Anda tidak cukup!");
                    return;
                }
                
                withdrawBtn.disabled = true;
                loadingOverlay.style.display = 'flex';

                setTimeout(() => {
                    const isSuccess = Math.random() < 0.9; // 50% chance of success
                    loadingOverlay.style.display = 'none';
                    withdrawBtn.disabled = false;
                    
                    if (isSuccess) {
                        dollarBalance -= amount;
                        rpBalance += amount;
                        updateBalances();
                        showCustomMessage(withdrawModal, `Penarikan berhasil! Anda mendapatkan ${amount.toLocaleString('id-ID')} Rp.`);
                    } else {
                        // Fail scenario: show 404 page
                        mainPage.style.display = 'none';
                        gamePage.style.display = 'none';
                        quizPage.style.display = 'none';
                        withdrawModal.classList.remove('visible');
                        error404Page.style.display = 'flex';
                    }
                }, 5000); // 5 seconds loading
            }
            
            function showCustomModal(text, type) {
                const modal = document.createElement('div');
                modal.classList.add('modal-overlay', 'visible');
                modal.innerHTML = `
                    <div class="modal-content">
                        <h2 class="text-2xl font-bold mb-4">${type === "success" ? "Berhasil!" : "Gagal!"}</h2>
                        <p class="text-lg mb-6">${text}</p>
                        <button class="main-button w-full" id="close-custom-modal">Tutup</button>
                    </div>
                `;
                document.body.appendChild(modal);
                document.getElementById('close-custom-modal').addEventListener('click', () => {
                    modal.classList.remove('visible');
                    setTimeout(() => modal.remove(), 300);
                });
            }

            function showCustomMessage(modal, text) {
                const messageDiv = modal.querySelector('.message-box') || document.createElement('div');
                if (!modal.querySelector('.message-box')) {
                    messageDiv.classList.add('message-box', 'visible', 'mt-4');
                    messageDiv.innerHTML = `<p class="font-bold text-yellow-300">${text}</p>`;
                    modal.querySelector('.modal-content').appendChild(messageDiv);
                } else {
                    modal.querySelector('.message-box').querySelector('p').textContent = text;
                    modal.querySelector('.message-box').classList.add('visible');
                }
                setTimeout(() => {
                     messageDiv.classList.remove('visible');
                }, 3000);
            }
            
            function showAgreementPage(amount, time, provider) {
                const loanAmount = parseInt(amount);
                const repaymentTime = parseInt(time);

                if (isNaN(loanAmount) || loanAmount < 1000000 || loanAmount > 50000000 || isNaN(repaymentTime) || repaymentTime < 1 || repaymentTime > 10) {
                    showCustomModal('Data tidak valid! Periksa jumlah pinjaman (1-50 Juta) dan waktu pengembalian (1-10 menit).', 'error');
                    return;
                }
                
                let loanObj = provider === 'bankkey' ? bankkeyLoan : pinjolLoan;
                if (loanObj.totalOwed > 0) {
                    showCustomModal(`Anda sudah memiliki pinjaman aktif di ${provider}. Mohon lunasi terlebih dahulu.`, 'error');
                    return;
                }

                let interestRate = 0;
                if (loanAmount <= 25000000) {
                    interestRate = 1 + Math.random() * 4;
                } else {
                    interestRate = 10 + Math.random() * 10;
                }

                const timeInterest = 1 + Math.random() * 4;
                interestRate += timeInterest;

                if (provider === 'pinjol') {
                    interestRate *= 2;
                }

                const interestAmount = loanAmount * (interestRate / 100);
                const totalOwed = loanAmount + interestAmount;

                currentLoan = {
                    provider,
                    amount: loanAmount,
                    totalOwed,
                    repaymentTime
                };
                
                if (provider === 'bankkey') {
                    bankkeyLoanAmountAgree.textContent = `Rp ${loanAmount.toLocaleString('id-ID')}`;
                    bankkeyTotalOwedAgree.textContent = `Rp ${Math.round(totalOwed).toLocaleString('id-ID')}`;
                    bankkeyRepaymentTimeAgree.textContent = repaymentTime;
                    loanFormPage.style.display = 'none';
                    bankkeyAgreementPage.style.display = 'flex';
                } else {
                    pinjolLoanAmountAgree.textContent = `Rp ${loanAmount.toLocaleString('id-ID')}`;
                    pinjolTotalOwedAgree.textContent = `Rp ${Math.round(totalOwed).toLocaleString('id-ID')}`;
                    pinjolRepaymentTimeAgree.textContent = repaymentTime;
                    pinjolFormPage.style.display = 'none';
                    pinjolAgreementPage.style.display = 'flex';
                }
            }

            function handleLoanApproval(provider) {
                let loanObj = provider === 'bankkey' ? bankkeyLoan : pinjolLoan;
                
                loanObj.amount = currentLoan.amount;
                loanObj.totalOwed = currentLoan.totalOwed;
                loanObj.repaymentTime = currentLoan.repaymentTime;
                loanObj.timerStart = Date.now();
                
                rpBalance += loanObj.amount;
                updateBalances();

                startLoanRepaymentTimer(loanObj, provider);

                if (provider === 'bankkey') {
                    bankkeyAgreementPage.style.display = 'none';
                } else {
                    pinjolAgreementPage.style.display = 'none';
                }
                mainPage.style.display = 'flex';
                showCustomModal(`Pinjaman ${provider} sebesar Rp ${loanObj.amount.toLocaleString('id-ID')} telah ditambahkan ke saldo Anda! Total yang harus dikembalikan Rp ${Math.round(loanObj.totalOwed).toLocaleString('id-ID')}.`, 'success');
                currentLoan = null;
            }
            
            function startLatePaymentPenalty(loan, provider) {
                if (loan.debtWarningInterval) clearInterval(loan.debtWarningInterval);
                
                loan.debtWarningInterval = setInterval(() => {
                    showDebtWarning(loan, provider);
                    loan.debtWarningCount++;
                    
                    if (loan.debtWarningCount % 5 === 0 && loan.debtWarningIntervalDuration > 10000) {
                        loan.debtWarningIntervalDuration -= 5000;
                        if (loan.debtWarningInterval) clearInterval(loan.debtWarningInterval);
                        startLatePaymentPenalty(loan, provider);
                    }

                }, loan.debtWarningIntervalDuration);
            }
            
            function showDebtWarning(loan, provider) {
                let message;
                let isDet = loan.debtWarningIntervalDuration <= 10000;

                if (isDet) {
                    const penaltyAmount = loan.totalOwed * 0.01;
                    loan.totalOwed += penaltyAmount;
                    message = `Iklan det! Utang ${provider} Anda bertambah Rp ${Math.round(penaltyAmount).toLocaleString('id-ID')}. Bank akan selalu meneror Anda.`;
                    updateBalances();
                } else {
                    message = `Segera bayar utang ${provider} Anda! Waktu pengembalian telah habis.`;
                }

                debtWarningText.textContent = message;
                debtWarning.style.display = 'flex';
                sirenSound.play();

                setTimeout(() => {
                    debtWarning.style.display = 'none';
                    sirenSound.pause();
                    sirenSound.currentTime = 0;
                }, 5000);
            }

            function startLoanRepaymentTimer(loan, provider, elementId) {
                const durationInSeconds = loan.repaymentTime * 60;
                let timerDisplay;
                if (elementId) {
                    timerDisplay = document.getElementById(elementId);
                } else {
                    timerDisplay = provider === 'bankkey' ? bankkeyRepaymentTimerDisplay : pinjolRepaymentTimerDisplay;
                }

                if (loan.repaymentInterval) clearInterval(loan.repaymentInterval);

                loan.repaymentInterval = setInterval(() => {
                    const elapsedTime = (Date.now() - loan.timerStart) / 1000;
                    const remainingTime = Math.max(0, durationInSeconds - elapsedTime);
                    const minutes = Math.floor(remainingTime / 60);
                    const seconds = Math.floor(remainingTime % 60);

                    if (timerDisplay) {
                       timerDisplay.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                    }
                    
                    if (remainingTime <= 0) {
                        clearInterval(loan.repaymentInterval);
                        loan.repaymentInterval = null;
                        
                        showCustomModal(`Waktu pengembalian pinjaman ${provider} habis! Anda harus membayar Rp ${Math.round(loan.totalOwed).toLocaleString('id-ID')}.`, 'error');
                        startLatePaymentPenalty(loan, provider);
                    }
                }, 1000);
            }
            
            function handleSpin() {
                const totalBet = parseInt(betAmountSlider.value);
                const spinCount = parseInt(spinCountSlider.value);

                if (dollarBalance < totalBet) {
                    messageText.textContent = "Saldo $ Anda tidak cukup untuk bermain!";
                    messageBox.classList.add('visible');
                    return;
                }

                dollarBalance -= totalBet;
                updateBalances();
                winningSpins = 0;
                spinBtn.disabled = true;
                messageBox.classList.remove('visible');
                
                runMultipleSpins(spinCount, totalBet);
            }

            function runMultipleSpins(spinsRemaining, totalBet) {
                if (spinsRemaining === 0) {
                    setTimeout(() => {
                        spinBtn.disabled = false;
                        const winningPerSpin = (totalBet / parseInt(spinCountSlider.value)) * 3;
                        const totalWinnings = winningSpins * winningPerSpin;
                        messageText.textContent = `Selesai! Anda menang sebanyak ${winningSpins} kali. Total kemenangan: ${totalWinnings.toLocaleString('en-US')} $.`;
                        messageBox.classList.add('visible');
                    }, 1000);
                    return;
                }

                totalSpins++;
                roundCounter.textContent = totalSpins; 
                
                reels.forEach(reel => {
                    reel.classList.remove('winning', 'bombing');
                    reel.classList.add('shaking');
                });
                
                spinSound.currentTime = 0;
                spinSound.play();

                let finalSymbols = [];
                let isJackpotWin = Math.random() < jackpotChance;
                let isBombing = false;
                let isWinning = false;

                const initialWinChance = 0.5;
                const minWinChance = 0.2;
                const winChanceDecrementPerStep = 0.03;
                const winChanceDecrementInterval = 10;
                const constantWinChanceRounds = 5;

                let currentWinChance = initialWinChance;
                if (totalSpins > constantWinChanceRounds) {
                    const roundsAfterInitial = totalSpins - constantWinChanceRounds;
                    const decrementCount = Math.floor(roundsAfterInitial / winChanceDecrementInterval);
                    currentWinChance = initialWinChance - (decrementCount * winChanceDecrementPerStep);
                    currentWinChance = Math.max(currentWinChance, minWinChance);
                }

                const initialBombChance = 0.03;
                const maxBombChance = 0.30;
                const bombChanceIncrementPerStep = 0.03;
                const bombChanceIncrementInterval = 10;

                let currentBombChance = 0;
                if (totalBet >= bombBetThreshold) {
                    const incrementCount = Math.floor(totalSpins / bombChanceIncrementInterval);
                    currentBombChance = initialBombChance + (incrementCount * bombChanceIncrementPerStep);
                    currentBombChance = Math.min(currentBombChance, maxBombChance);
                }
                
                if (isJackpotWin) {
                    finalSymbols = ['üçÄ', 'üçÄ', 'üçÄ'];
                } else if (totalBet >= bombBetThreshold && Math.random() < currentBombChance) {
                    finalSymbols = ['üí£', 'üí£', 'üí£'];
                    isBombing = true;
                } else {
                    isWinning = Math.random() < currentWinChance;
                    
                    if (isWinning) {
                        const regularSymbols = symbols.filter(s => s !== 'üçÄ' && s !== 'üí£');
                        const winningSymbol = regularSymbols[Math.floor(Math.random() * regularSymbols.length)];
                        finalSymbols.push(winningSymbol, winningSymbol, winningSymbol);
                    } else {
                        finalSymbols.push(
                            symbols[Math.floor(Math.random() * symbols.length)],
                            symbols[Math.floor(Math.random() * symbols.length)],
                            symbols[Math.floor(Math.random() * symbols.length)]
                        );
                    }
                }

                spinReels(finalSymbols, isJackpotWin || isWinning || isBombing, () => {
                    spinSound.pause();
                    spinSound.currentTime = 0;
                    
                    if (isJackpotWin || isWinning) {
                        winSound.play();
                    } else {
                        loseSound.play();
                    }
                    
                    if (isJackpotWin) {
                        dollarBalance += jackpotAmount;
                        messageText.textContent = `JACKPOT! ANDA MEMENANGKAN ${jackpotAmount.toLocaleString('en-US')} $!`;
                    } else if (isBombing) {
                        const lossAmount = totalBet * bombPenaltyMultiplier;
                        dollarBalance -= lossAmount;
                        messageText.textContent = `BOOM! Anda kehilangan ${lossAmount.toLocaleString('en-US')} $!`;
                    } else if (isWinning) {
                        const winningPerSpin = (totalBet / parseInt(spinCountSlider.value)) * 3;
                        dollarBalance += winningPerSpin;
                        winningSpins++;
                        messageText.textContent = "SELAMAT, ANDA MENANG!";
                    } else {
                        messageText.textContent = "COBA LAGI!";
                    }
                    
                    updateBalances();
                    messageBox.classList.add('visible');
                    
                    setTimeout(() => runMultipleSpins(spinsRemaining - 1, totalBet), 1000);
                });
            }

            function spinReels(finalSymbols, resultIsSpecial, callback) {
                const spinDuration = 2500;
                const interval = 200;

                reels.forEach((reel, index) => {
                    const symbolElement = reel.querySelector('.symbol');
                    let spinInterval = setInterval(() => {
                        const randomSymbol = symbols[Math.floor(Math.random() * symbols.length)];
                        symbolElement.textContent = randomSymbol;
                    }, interval);

                    setTimeout(() => {
                        clearInterval(spinInterval);
                        symbolElement.textContent = finalSymbols[index];
                        reel.classList.remove('shaking');

                        if (index === reels.length - 1) {
                            if (resultIsSpecial) {
                                if (finalSymbols[0] === 'üí£') {
                                     reels.forEach(reel => reel.classList.add('bombing'));
                                } else {
                                     reels.forEach(reel => reel.classList.add('winning'));
                                }
                            } else {
                                reels.forEach(reel => reel.classList.remove('winning', 'bombing'));
                            }
                            callback();
                        }
                    }, spinDuration + (index * 500));
                });
            }
            
            function startQuiz() {
                questionsToAsk = allQuestions.sort(() => 0.5 - Math.random()).slice(0, 10);
                currentQuestionIndex = 0;
                showQuestion();
                quizMessageBox.classList.remove('visible');
                updateBalances();
            }
            
            function showQuestion() {
                if (currentQuestionIndex >= questionsToAsk.length) {
                    quizMessageText.textContent = "Kuis selesai! Anda bisa kembali ke halaman utama.";
                    quizMessageBox.classList.add('visible');
                    answerOptionsContainer.innerHTML = '';
                    return;
                }

                const questionData = questionsToAsk[currentQuestionIndex];
                quizCounter.textContent = currentQuestionIndex + 1;
                questionTextElement.textContent = questionData.question;
                
                answerOptionsContainer.innerHTML = '';
                questionData.options.forEach((option, index) => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.classList.add('quiz-option-btn');
                    button.addEventListener('click', () => checkAnswer(index));
                    answerOptionsContainer.appendChild(button);
                });
            }

            function checkAnswer(selectedIndex) {
                const questionData = questionsToAsk[currentQuestionIndex];
                const isCorrect = selectedIndex === questionData.correctAnswerIndex;
                
                if (isCorrect) {
                    rpBalance += 50000;
                    quizMessageText.textContent = "Jawaban Benar! Anda mendapatkan 50.000 Rp.";
                    quizMessageBox.classList.add('visible');
                } else {
                    rpBalance -= 10000;
                    quizMessageText.textContent = "Jawaban Salah. Saldo Anda berkurang 10.000 Rp.";
                    quizMessageBox.classList.add('visible');
                }
                
                updateBalances();

                const buttons = answerOptionsContainer.querySelectorAll('.quiz-option-btn');
                buttons.forEach(btn => btn.disabled = true);

                setTimeout(() => {
                    currentQuestionIndex++;
                    showQuestion();
                    if (currentQuestionIndex < questionsToAsk.length) {
                         quizMessageBox.classList.remove('visible');
                    }
                }, 1500);
            }
        });
    </script>
</body>
</html>
